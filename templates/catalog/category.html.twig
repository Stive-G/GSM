{% extends 'base.html.twig' %}

{% block body %}
    <h1>{{ category.name }}</h1>

    <form method="get" class="mb-3">
        <label>Recherche texte <input type="text" name="q" value="{{ filters.text }}"></label>
        <label>Marque <input type="text" name="brand" value="{{ filters.brand }}"></label>
        <label>Prix min <input type="number" step="0.01" name="priceMin" value="{{ filters.priceMin }}"></label>
        <label>Prix max <input type="number" step="0.01" name="priceMax" value="{{ filters.priceMax }}"></label>
        <label>Tri
            <select name="sort">
                <option value="">Pertinence</option>
                <option value="price_asc" {% if filters.sort == 'price_asc' %}selected{% endif %}>Prix croissant</option>
                <option value="price_desc" {% if filters.sort == 'price_desc' %}selected{% endif %}>Prix décroissant</option>
                <option value="newest" {% if filters.sort == 'newest' %}selected{% endif %}>Nouveautés</option>
                <option value="name" {% if filters.sort == 'name' %}selected{% endif %}>Nom</option>
            </select>
        </label>
        <button type="submit">Filtrer</button>
    </form>

    <div>
        {% for product in products %}
            <article>
                <h2><a href="{{ path('catalog_product', { slug: product.slug }) }}">{{ product.name }}</a></h2>
                <p>{{ product.description|default('') }}</p>
                {% set variant = product.variants[0] ?? null %}
                {% if variant %}
                    <p>Prix TTC : {{ variant.price.ttc }} {{ variant.price.currency }}</p>
                {% endif %}
            </article>
        {% else %}
            <p>Aucun produit pour cette catégorie.</p>
        {% endfor %}
    </div>
{% endblock %}
